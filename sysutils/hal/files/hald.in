#!/bin/sh
#
# $FreeBSD$
#
# PROVIDE: hald
# REQUIRE: DAEMON dbus polkitd
#
# Add the following line to /etc/rc.conf to enable the HAL daemon:
#
# hald_enable="YES"
#

hald_enable=${hald_enable-"NO"}
hald_flags=${hald_flags-""}

. %%RC_SUBR%%

name=hald
rcvar=`set_rcvar`

command="%%PREFIX%%/sbin/hald"
pidfile="/var/run/${name}/${name}.pid"

stop_postcmd="hald_postcmd"
start_precmd="hald_precmd"

hald_precmd()
{
    if ! checkyesno dbus_enable
    then
	force_depend dbus || return 1
    fi

    if ! checkyesno polkitd_enable
    then
	force_depend polkitd || return 1
    fi

    mkdir -p $(dirname $pidfile)
}

hald_postcmd()
{
    rm -f $pidfile
}

load_rc_config ${name}
run_rc_command "$1"
